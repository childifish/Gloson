# GLOSON     :pray:å¸Œæœ›äººæ²¡äº‹

ğŸ¤£ä¸çŸ¥é“æ˜¯å¦é«˜æ•ˆä½†åº”è¯¥ä¸é«˜æ•ˆçš„è¶…ç®€é™‹JSONæ¡†æ¶(for golang)ğŸ™‚

### å®ç°äº†

- ##### ç®€å•JSONçš„ååºåˆ—åŒ–:blush:

  ```go
  	s := "{\n\"name\":\"ç½‘ç«™\",\n\"num\":3,\n\"sites\":[1,2,3]\n}"
  	type AutoGenerated struct {
  		Name  string  `json:"name"`
  		Num   int     `json:"num"`
  		Sites []int64 `json:"sites"`
  	}
  	a := &AutoGenerated{}
  	err := gloson.Bind(s, a)
  	if err == nil {
  		fmt.Printf("%+v", a)
  	}
  ```

  è¾“å‡ºç»“æœä¸º

  ```
  === RUN   Test2
  &{Name:"ç½‘ç«™" Num:3 Sites:[1 2 3]}--- PASS: Test2 (0.00s)
  PASS
  ```

- ##### å¤æ‚JSONçš„ååºåˆ—åŒ–ï¼ˆåµŒå¥—ï¼‰:alien:

  ```go
  	s := "{\n\"GlossDef\": {\n\"para\": \"as DocBook.\",\n\"GlossSeeAlso\":	{par:\"pppapp\",glo:1}\n},\n\"GlossSee\": \"markup\"\n}"
  	type GlossSeeAlso struct {
  		Par string `json:"par"`
  		Glo int    `json:"glo"`
  	}
  	type GlossDef struct {
  		Para         string       `json:"para"`
  		GlossSeeAlso GlossSeeAlso `json:"GlossSeeAlso"`
  	}
  	type AutoGenerated struct {
  		GlossDef GlossDef `json:"GlossDef"`
  		GlossSee string   `json:"GlossSee"`
  	}
  	a := &AutoGenerated{}
  	err := gloson.Bind(s, a)
  	if err == nil {
  		fmt.Printf("%+v", a)
  	}
  ```

  è¾“å‡ºç»“æœä¸º

  ```
  === RUN   TestBind
  &{GlossDef:{Para:"asDocBook." GlossSeeAlso:{Par:"pppapp" Glo:1}} GlossSee:"markup"}--- PASS: TestBind (0.00s)
  PASS
  ```

- ##### ç®€å•JSONçš„åºåˆ—åŒ–:+1:

  ```go
  	type AutoGenerated struct {
  		Name bool      `json:"name"`
  		Num  []float64 `json:"num"`
  		Test []string  `json:"test"`
  	}
  	a := &AutoGenerated{
  		Name: false,
  		Num:  []float64{123120.123, 4.2317823019, 6, 8273},
  		Test: []string{"", "~!!@##$%%^&^&*(){}:}|", "asiojdoa"},
  	}
  	s, _ := gloson.Marshall(a)
  	fmt.Println(s)
  ```

  è¾“å‡ºç»“æœä¸º

  ```
  === RUN   Test5
  {
      "name":false,
      "num":[123120.123, 4.2317823019, 6, 8273],
      "test":["", "~!!@##$%%^&^&*(){}:}|", "asiojdoa"]
  }
  --- PASS: Test5 (0.00s)
  PASS
  ```



### :clap:å®ç°è¿‡ç¨‹

#### åºåˆ—åŒ–:v:

- é€šè¿‡åå°„ï¼ˆreflectï¼‰ï¼Œå¯ä»¥è·å¾—ä¼ å…¥ç»“æ„ä½“çš„ä¿¡æ¯ï¼Œæœ€é‡è¦çš„æ˜¯`reflect.TypeOf(ï¼‰`å’Œ`reflect.ValueOf(ï¼‰`

  è¿™ä¸¤ä¸ªå‡½æ•°ï¼š

  ```go
  func (glom *GlosonMa) ViewItem() error {
  	ObjTyp := reflect.TypeOf(glom.Object).Elem()
  	fNum := ObjTyp.NumField()
  	glom.ItemNum = fNum
  	tagMap := make(map[int]Item)
  	for i := 0; i < fNum; i++ {
  		key := ObjTyp.Field(i).Tag.Get("json")
  		if key == "" {
  			return errors.New("void tag")
  		}
  		t := reflect.ValueOf(glom.Object)
  		if t.Kind() == reflect.Ptr {
  			t = t.Elem()
  		}
  		if t.Field(i).Kind() == reflect.Struct {
  			glom.Nesting = append(glom.Nesting, i)
  		}
  		value := t.Field(i).Interface()
  		tagMap[i] = Item{
  			Name:  key,
  			Value: value,
  		}
  	}
  	glom.TagMap = tagMap
  	return nil
  }
  ```

  - `ObjTyp := reflect.TypeOf(glom.Object).Elem()`

  - `fNum := ObjTyp.NumField()`è·å–äº†ä¼ å…¥ç»“æ„ä½“çš„å­—æ®µæ•°ï¼Œä¾¿äºåç»­çš„éå†